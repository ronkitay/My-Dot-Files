#!/bin/sh

local file_to_preview
file_to_preview=$(echo $1 | awk '{$1=""; print $0}')

GIT_PAGER=cat
GIT_STATUS=$(git status --short | egrep "$file_to_preview" | awk '{print $1}')

if [[ "${GIT_STATUS:0:2}" == "??" ]]; 
then
    if [[ -d $file_to_preview ]];
    then
        tree -L 2 -C $file_to_preview
    else
        bat -n --color=always $file_to_preview
    fi
fi

if [[ "${GIT_STATUS}" == "D" ]]; 
then
    echo "${BRIGHT}${YELLOW}$1${NORMAL} has been ${BRIGHT}${RED}DELETED${NORMAL}"
fi

if [[ "${GIT_STATUS}" = M* || "${GIT_STATUS}" == " M" || "${GIT_STATUS}" == "MM" ]]; 
then
    git diff --no-ext-diff --color=always -C $file_to_preview | head -200
fi
